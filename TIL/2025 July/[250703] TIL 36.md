# SQL 코드카타 169- 172

169.
- 문제 해설: 계층적 구조를 띄는 회사의 각 직무 별 담당 인원 수를 구하시오
```sql
select c.company_code,
    c.founder,
    count(distinct lead_manager_code),
    count(distinct senior_manager_code),
    count(distinct manager_code),
    count(distinct employee_code)
from employee e
left join company c 
        on e.company_code = c.company_code
group by c.company_code, c.founder
order by c.company_code asc
```
> ✅ 문제가 이해가 안가서 블로그 보고 하였음

170.
- 문제 해설:
```sql
select round(LAT_N, 4)
from(
    select LAT_N,
        PERCENT_RANK() OVER (ORDER BY LAT_N) as median
    from STATION
) as A
where median = 0.5
```
> PERCENT_RANK() 함수를 이용하면 중앙값을 구할 수 있음 -> 짝수 개를 구할 때 문제점 있음
> 다른 알고리즘 방법을 생각해 봐야 겠음

---

# 가설 검정의 주의점

# 6.1 재현 가능성
> ✅ 우연히 결과가 나오는 것이 아닌, 항상 일관된 결과가 나오는지 확인

# 6.2 p-해킹
## 1) p-해킹이란?
> 데이터 분석을 반복하여 p-값을 인위적으로 낮추는 행위
    유의마한 결과를 얻기 위해 다양한 변수를 시도하거나, 데이터를 계속 분석하는 등의 방법
### 문제점
- p-해킹은 데이터 분석 결과의 신뢰성을 저하
## 2) p-해킹은 언제 조심해야 하는가?
### 여러 가설 검정을 시도할 때
- 여러 가설 검정을 시도하며 유의미한 p-값을 얻을 때까지 반복 분석하는 것을 조심
- p-해킹은 유의한 결과를 얻기 위해 p-값이 0.05 이하인 결과만 선택적으로 보고하는 행위를 조심
- 데이터의 수를 늘리다보니 특정 데이터 수를 기록할 때 잠깐 p값이 0.05 이하를 기록함으로 이를 바탕으로 대립가설 채택하는 것을 조심
- 즉, 결과를 보며 데이터 개수를 늘려서는 안됨
- 다양한 상황 중에서 p값이 유리하게 나오는 상황만 선별적으로 보고하는 것을 조심
 다양한 변수를 건드리며 유리한 결과가 나올 때 다시 처음부터 가설을 그 결과에 맞게 세우는 것

 # 6.3 선택적 보고
 > 선택적으로 보고하는 것
 ## 1) 선택적 보고란?
 - 유의미한 결과만 보고, 유의미하지 않은 보고는 생략
 - 이는 데이터 분석 결과를 왜곡 및 신뢰성 저하
## 2) 선택적 보고는 언제 조심해야 하는가?
### 유의미한 결과만 공개할 때
- 다수의 데이터 분석 중 유의미한 결과가 나온 실험만을 보고서에 작성하여 발표
### 결과를 보면서 가설을 다시 새로 설정했는데 마치 처음부터 설정한 가설이라고 얘기할 때
- 미리 가설과 실험 방법 등에 대해서 설정을 한 다음 연구를 수행하거나 연구하는 동안 얻어진 모든 변수와 결과에 대해서 공개하지 못할 때

# 6.4 자료수집 중단 시점 결정
> 원하는 결과가 나올 때까지 자료를 수집하는 것을 조심!
## 1) 자료수집 중단 시점 결정?
- 데이터 수집을 시작하기 전에 언제 수집을 중단할지 명확하게 결정하지 않으면, 원하는 결과가 나올 때까지 데이터를 계속 수집할 수 있음. -> 결과의 신뢰성 저하
- 이상적으로는 사전에 정해진 계획에 따라야 함
## 2) 자료수집 중단 시점은 언제 조심해야 하는가?
### 결과를 이미 정해놓고 그에 맞추기 위해 자료수집을 하고자 할 때
- 50명의 데이터를 수집하기로 했으나, 원하는 결과가 나오지 않자 100명까지 추가로 수집
