# SQL 코드카타 166-168

165.
```sql
select sum(ct.population)
from city ct
join country cr
on ct.countrycode = cr.code
where cr.continent = 'Asia'
```

166.
- 문제 해설: CITY와 COUNTRY 테이블이 주어져 있을 때, COUNTRY 테이블에서 CONTINENT가 Africa인 곳의 도시 이름을 모두 출력하시오.
```sql
select ct.name
from city ct 
join country cr
on ct.countrycode = cr.code
where cr.continent = 'Africa'
```

167.
- 문제 해설: country.contient의 모든 이름을 출력하고 인구 수의 평균 값을 가장 가까운 정수의 내림으로 출력하라.
```sql
select cr.continent
    ,   truncate(avg(ct.population), 0) -- TRUNCATE 내림 함수
from city ct
join country cr
on ct.countrycode = cr.code
group by cr.continent

```

168.
- 문제 해설: bst테이블에 n과 p가 있을 때, Root, Inner, Leaf로 구분하여 n과 p를 출력하시오. 노드 번호대로 정렬하시오.
```sql
select distinct b1.n,
    case
    when b2.n is null then 'Leaf'
    when b1.p is null then 'Root'
    else 'Inner'
    end as p 
from bst as b1
left join bst as b2 
on b1.n = b2.p
order by b1.n asc
```
> 와 이거 푼다고 머리 터질 뻔 했다.

---

# Python 코드카타 91

91.
```python

```

---

# 실무에서 쓰이는 ML
# 3. 이상치(Outlier) 탐지 및 제거
## 이상치 정의
- 정상 범주에서 크게 벗어나는 값
- 장비 오작동, 환경적 특이 상황 등 원인이 다양함
## 탐지 기법
1. 통계적 기법(3σ Rule)
- 데이터가 정규분포를 따른다고 가정하고, 평균에서 +-3σ(표준편차) 범위를 벗어나는 값을 이상치로 간주
- 직관적이고 간단. 정규성 가정이 틀릴 수 있음.
2. 박스플롯(Box plot) 기준
- 사분위수(IQR = Q3 - Q1)를 이용해 Q1 - 1.5xIQR, Q3 + 1.5xIQR을 벗어나는 데이터를 이상치로 간주
- 분포 특성에 영향을 적게 받는 장점
3. 머신러닝 기반
- 이상치 탐지 알고리즘
- 복잡한 패턴으 고려할 수 있음
## 처리 기법
1. 이상치 제거
2. 이상치 조정(클리핑, WInsorizing)
3. 별도 구분, 다른 모델로 활용

# 4. 정규화/표준화(스케일링)
## 왜 필요한가?
1. 모델(특히 거리 기반 알고리즘, 딥러닝)에 따라 특정 변수의 스케일이 크게 영향을 미칠 수 있음
2. 센서 A는 값 범위가 0~1000, 센서 B는 값 범위가 0~1이라면 A가 모델에 더 큰 영향을 줌
## 정규화
1. MinMaxScaler
: 모든 값을 0과 1사이로 매핑
2. 특징
- 값의 스케일이 달라도 공통 범위로 맞출 수 있음
- 딥러닝(신경망), 이미지 처리 등에서 입력값을 0~1로 제한해야 하거나, 각 특성이 동일한 범위 내 있어야 하는 경우 자주 사용
- 거리 기반 알고리즘(유클리디안 거리 사용)이나, 각 특성의 범위를 동일하게 맞춤으로써 계산 안정성을 높이고 싶을 때.
- 최소.최대값이 극단값(Outlier)에 민감.
- 새로운 데이터가 기존 최대값보다 커지거나 최소값보다 작아지는 경우, 스케일링 범위를 벗어날 수 있어 재학습하거나 다른 처리 필요
## 표준화
1. StandardScaler
: 평균을 0, 표준편차를 1로 만듦
2. 특징
- 분포가 정규분포에 가깝게 변형됨
- 평균 0, 표준편차 1이므로 정규분포 가정을 사용하는 알고리즘
- 변환된 값들이 이론적으로 -무한~+무한 범위를 가질 수 있다.
- 데이터가 특정 구간에 고정되지는 않는다
- 데이터 분포가 심하게 치우쳐 있으면, 평균과 표준편차만으로는 충분한 스케일링이 되지 않을 수 있다.

# 5. 불균형 데이터 처리
: 정상 99%, 불량 1%처럼 한 클래스가 극도로 적은 경우
## 문제점
- 모델이 극도로 적은 클래스를 거의 예측하지 못할 가능성이 큼(Bias 발생)
## 해결 기법
1. Oversampling
- Random Oversampling
    - 소수 클래스의 데이터를 단순 복제하여 개수를 늘림
- SMOTE(Synthetic Minority Over-sampling Technique)
    - 소수 클래스를 무작정 복사만 하는 게 아니라, 비슷한 데이터들을 서로 섞어서 새로운 데이터 생성
    - 소수 클래스 안에서 가까운 데이터 둘을 고르고 그 사이에 새 데이터 포인트를 만들어내어, 소수 클래스의 다양한 예시를 가상으로 늘리는 기법
2. Undersampling
- 다수 클래스 데이터를 줄이는 방식
- 데이터 손실 위험이 있지만, 전체 데이터 균형을 맞출 수 있음
3. 혼합 기법
- SMOTE와 언더샘플링을 적절히 섞어서 사용

# 6. 범주형 데이터 변환
## 원-핫 인코딩(One-Hot Encoding)
- 범주형 변수를 각각의 범주별로 새로운 열로 표현, 해당 범주에 해당하면 1 아니면 0
- 장점: 범주 간 서열 관계가 없을 때 사용하기 좋음
- 단점: 범주가 매우 많음녀 차원이 커짐
## 레이블 인코딩(Label Encoding)
- 범주를 숫자로 직접 맵핑
- 단순하지만, 모델이 숫자의 크기를 서열 정보로 잘못 해석할 수 있음

# 7. 피처 엔지니어링
: 모델 성능 향상을 위해 기존 데이터를 변형, 조합하여 새로운 특성(피처)을 만드는 작업
## 중요성
1. 복잡한 데이터 구조 안에 존재하는 패턴을 효과적으로 추출해 모델이 쉽게 학습하게 함

# 8. 피처 엔지니어링 실습 예시
## 파생 변수 생성
1. 날짜 파생 변수
2. 수치형 변수 조합
3. 로그 변환, 제곱근 변환 등
## 변수 선택(Feature Selection)
- 상관관계
    - 두 변수 간 상관도가 높은 상황인 경우 다중공선성 의심. 하나만 남기거나 둘 다 제거 고려
- VIF
    - 회귀분석에서 다중공선성 문제를 파악할 때 사용
- 모델 기반 중요도
    - 트리 기반 모델을 훈련 후 중요도가 낮은 변수 제거
## 변수 간 상호작용 추가
- 다항식/교차 항 생성